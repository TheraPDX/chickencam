<html>
<head>
<title>ChickenCam</title>
<script src="/static/js/jquery-2.2.4.min.js"></script>
<script src="/static/js/jquery.lazyload.min.js"></script>
<!-- <link rel="stylesheet" href="/static/css/picnic.min.css"> -->
<script>
$(function() {
    $("img.lazy").lazyload({
      threshold : 200,
      effect : "fadeIn",
    });

});
</script>
<link rel="apple-touch-icon" sizes="57x57" href="/static/img/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/img/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/img/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/img/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/img/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/img/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/img/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/img/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/img/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/static/img/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicon-16x16.png">
<link rel="manifest" href="/static/img/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="/static/css/bootstrap.min.css">
<script src="/static/js/bootstrap.min.js"></script>
<link href="/static/css/toastr.min.css" rel="stylesheet"/>
<script src="/static/js/toastr.min.js"></script>


</head>
<body>



  <div class="container">
      <div class="row">
        <div class="col-sm-4">
          <h1>ChickenCam v. 2.0</h1>
          <h2>What do chickens do all day?</h2>
          <img class="lazy" data-original="/static/img/chicken.png" width=100>
        </div>
        <div class="col-sm-6 col-sm-offset-2">
          <div class="panel panel-primary">

            <div class="panel-heading">
             <h3 class="panel-title">Live</h3>
            </div>

           <div class="panel-body">
             <img class="lazy" data-original="/static/data/current.jpg?{{ $.Data.RandomNumber }}" width="100%">
           </div>
          </div>
        </div>
      </div>

      <div class="row">
        {{range $i, $date := .Data.SortedDates}}
        {{ $activity := index $.Data.Activity $i}}
        <div class="col-sm-6 col-md-4" id="{{index $.Data.SortedHashes $i}}">
          <div id="panel{{index $.Data.SortedHashes $i}}" class="panel {{ if eq $activity ""}}panel-primary{{ else if eq $activity "egg"}}panel-success{{ else if eq $activity "chicken"}}panel-warning{{ end }}">

            <div class="panel-heading">
             <h3 class="panel-title"><a href="#{{index $.Data.SortedHashes $i}}">{{ $date }}</a></h3>
            </div>

           <div class="panel-body">
             <img class="lazy" data-original="/static/data/{{index $.Data.SortedNames $i}}.jpg" width="100%">
             <audio controls preload="none" class="lazy">
               <source src="/static/data/{{index $.Data.SortedNames $i}}.mp3" type="audio/mp3">
             Your browser does not support the audio element.
             </audio>
           </div>

           <div class="panel-footer">
             <form action="/update" method="post" id="form{{index $.Data.SortedHashes $i}}">
               <div class="row">
                 <input type="hidden" name="id" value="{{index $.Data.SortedHashes $i}}">
                 <div class="form-check col-sm-4">
                   <fieldset class="form-group">
                     <div class="form-check">
                       <label class="form-check-label">
                         <input type="radio" class="form-check-input" name="activity" id="optionsRadios1" value=""  {{ if eq $activity ""}}checked{{ end }}>
                         None
                       </label>
                     </div>
                     <div class="form-check">
                     <label class="form-check-label">
                         <input type="radio" class="form-check-input" name="activity" id="optionsRadios2" value="chicken" {{ if eq $activity "chicken"}}checked{{ end }}>
                         In view
                       </label>
                     </div>
                     <div class="form-check disabled">
                     <label class="form-check-label">
                         <input type="radio" class="form-check-input" name="activity" id="optionsRadios3" value="egg" {{ if eq $activity "egg"}}checked{{ end }}>
                         Laying egg
                       </label>
                     </div>
                   </fieldset>
                 </div>
                 <div class="form-group col-sm-8">
                   <label for="exampleTextarea">Other notes:</label>
                   <textarea class="form-control" name="notes" rows="2">{{index $.Data.Notes $i}}</textarea>
                 </div>
                 <div class="form-group col-sm-12">
                   <div class="form-check">
                     <button type="submit" class="btn btn-primary btn-block update_form">Submit</button>
                   </div>
                 </div>
                 <span class="clearfix">
               </div>
             </form>
           </div>
          </div>
        </div>
        {{ end }}
      </div>

      <div class="row">
        {{range $i, $val := .Data.ParseableDates}}
        <div class="col-sm-6">
          <h2><a href="/date/{{ $val }}">{{index $.Data.AvailableDates $i}}</a> ({{index $.Data.PictureCounts $val}} photos)</h2>
        </div>
         {{ end }}
      </div>
  </div>






<script>
// this is the class of the submit button
$(function () {
    $('form').on('submit', function (e) {
        $.ajax({
            type: 'post',
            url: '/update',
            data: $(this).serialize(),
            success: function (data) {
              console.log($(this).serialize());
               console.log(data); // show response from the php script.
               toastr.success('ID ' + data.id + " updated", 'Thanks!', {timeOut: 3000})
               if (data.activity == "") {
                 $('#panel'+data.id).removeClass().addClass('panel panel-primary');
               }
               if (data.activity == "egg") {
                 $('#panel'+data.id).removeClass().addClass('panel panel-success');
               }
               if (data.activity == "chicken") {
                 $('#panel'+data.id).removeClass().addClass('panel panel-warning');
               }
            },
            error: function (data) {

              toastr.error('Something went wrong!', 'Uh oh!', {timeOut: 3000})
            }

        });
        e.preventDefault();
    });
});

</script>

</body>
</html>
